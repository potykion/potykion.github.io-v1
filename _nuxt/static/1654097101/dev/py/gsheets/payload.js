__NUXT_JSONP__("/dev/py/gsheets", (function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_,$,aa,ab,ac,ad,ae,af,ag,ah,ai,aj,ak,al,am,an,ao,ap,aq,ar,as,at,au,av,aw,ax,ay,az,aA,aB,aC,aD,aE,aF,aG,aH,aI,aJ,aK,aL,aM,aN,aO,aP,aQ,aR,aS,aT,aU,aV,aW,aX,aY,aZ,a_,a$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC){return {data:[{page:{slug:"gsheets",description:"Sheets API - одна из самых непонятных апишек, здесь я опишу понятное руководство по этой апишке на примере задачи обновления ссылок в таблице",title:"Python \u002F Работа с Google таблицами с помощью Sheets API",cover:"\u002Fimages\u002Fdev\u002Fpython\u002Fgsheets\u002Fcover.png",showToc:true,toc:[{id:aD,depth:S,text:aE},{id:aF,depth:S,text:aG},{id:aH,depth:S,text:aI},{id:aJ,depth:S,text:aK},{id:aL,depth:S,text:aM},{id:aN,depth:S,text:aO},{id:aP,depth:S,text:an}],body:{type:"root",children:[{type:b,tag:v,props:{className:[X]},children:[{type:a,value:f},{type:b,tag:t,props:{},children:[{type:a,value:"Чтобы работать с Гугл шитс апи, надо авторизоваться, а потом можно запросики кидать."}]},{type:a,value:f},{type:b,tag:t,props:{},children:[{type:a,value:"Но сначала пререквизиты:"}]},{type:a,value:f},{type:b,tag:Y,props:{id:aD},children:[{type:b,tag:r,props:{href:"#%D0%BF%D1%80%D0%B5%D1%80%D0%B5%D0%BA%D0%B2%D0%B8%D0%B7%D0%B8%D1%82%D1%8B",ariaHidden:B,tabIndex:C},children:[{type:b,tag:c,props:{className:[D,E]},children:[]}]},{type:a,value:aE}]},{type:a,value:f},{type:b,tag:Q,props:{},children:[{type:a,value:f},{type:b,tag:p,props:{},children:[{type:a,value:"Создать проект в Google Cloud + включить "},{type:b,tag:r,props:{href:"https:\u002F\u002Fconsole.cloud.google.com\u002Fapis\u002Flibrary\u002Fsheets.googleapis.com",rel:[F,G,H],target:I},children:[{type:a,value:"Sheets API"}]}]},{type:a,value:f},{type:b,tag:p,props:{},children:[{type:a,value:"Поставить клиентские либы:"}]},{type:a,value:f}]},{type:a,value:f},{type:b,tag:v,props:{className:[K]},children:[{type:b,tag:L,props:{className:[M,aQ]},children:[{type:b,tag:s,props:{},children:[{type:a,value:"pip install google-api-python-client google-auth-httplib2 google-auth-oauthlib\n"}]}]}]},{type:a,value:f}]},{type:a,value:f},{type:b,tag:v,props:{className:[X]},children:[{type:a,value:aa},{type:b,tag:Y,props:{id:aF},children:[{type:b,tag:r,props:{href:"#%D0%B0%D0%B2%D1%82%D0%BE%D1%80%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F",ariaHidden:B,tabIndex:C},children:[{type:b,tag:c,props:{className:[D,E]},children:[]}]},{type:a,value:aG}]},{type:a,value:f},{type:b,tag:Q,props:{},children:[{type:a,value:f},{type:b,tag:p,props:{},children:[{type:a,value:"Чтобы авторизоваться можно использовать "},{type:b,tag:aR,props:{},children:[{type:a,value:aS}]},{type:a,value:", можно использовать "},{type:b,tag:aR,props:{},children:[{type:a,value:"сервисный аккаунт"}]}]},{type:a,value:f},{type:b,tag:p,props:{},children:[{type:a,value:"OAuth нужен когда разные пользователи могут взаимодействовать с гугл таблицей"}]},{type:a,value:f},{type:b,tag:p,props:{},children:[{type:a,value:"Обычно нам это не надо, обычно у нас один пользователь какие-то операции над таблицей делает и все (мы просто апи методы хотим покидать, "},{type:b,tag:"em",props:{},children:[{type:a,value:"нам похуй ваще как это делать"}]},{type:a,value:", авторизоваться через гугл - нахуя?)"}]},{type:a,value:f},{type:b,tag:p,props:{},children:[{type:a,value:"Плюс это не наш вариант, потому что на сервере ты не будешь авторизовываться через гугл: открывать окошко, входить в гугл и все такое - на сервере нет такой возможности"}]},{type:a,value:f},{type:b,tag:p,props:{},children:[{type:a,value:"Соответсвенно, мы используем сервисный аккаунт"}]},{type:a,value:f}]},{type:a,value:f},{type:b,tag:U,props:{id:"servisnyy-akkaunt"},children:[{type:b,tag:r,props:{href:"#%D1%81%D0%B5%D1%80%D0%B2%D0%B8%D1%81%D0%BD%D1%8B%D0%B9-%D0%B0%D0%BA%D0%BA%D0%B0%D1%83%D0%BD%D1%82",ariaHidden:B,tabIndex:C},children:[{type:b,tag:c,props:{className:[D,E]},children:[]}]},{type:a,value:"Сервисный аккаунт"}]},{type:a,value:f},{type:b,tag:t,props:{},children:[{type:a,value:"Сервисный аккаунт - это специальный пользователь, которому даем доступы к гугловым сервисам (не только гугл шитс)"}]},{type:a,value:f},{type:b,tag:V,props:{},children:[{type:a,value:f},{type:b,tag:p,props:{},children:[{type:a,value:"То есть создаем пользователя"}]},{type:a,value:f}]},{type:a,value:f},{type:b,tag:Z,props:{},children:[{type:a,value:N},{type:b,tag:P,props:{src:"\u002Fimages\u002Fdev\u002Fpython\u002Fgsheets\u002Fservice-acc-creation-1.png",alt:"Страничка создания доступов"},children:[]},{type:a,value:N},{type:b,tag:P,props:{src:"\u002Fimages\u002Fdev\u002Fpython\u002Fgsheets\u002Fservice-acc-creation-2.png",alt:"Создание сервисного акка - достаточно только имя ввести"},children:[]},{type:a,value:f}]},{type:a,value:f},{type:b,tag:V,props:{start:aT},children:[{type:a,value:f},{type:b,tag:p,props:{},children:[{type:a,value:"Создаем апи-ключ для этого пользователя - с помощью ключа мы будем вызывать методы от имени сервисного акка"}]},{type:a,value:f}]},{type:a,value:f},{type:b,tag:Z,props:{},children:[{type:a,value:N},{type:b,tag:P,props:{src:"\u002Fimages\u002Fdev\u002Fpython\u002Fgsheets\u002Fservice-acc-page.png",alt:"Страничка сервисного акка"},children:[]},{type:a,value:N},{type:b,tag:P,props:{src:"\u002Fimages\u002Fdev\u002Fpython\u002Fgsheets\u002Fservice-acc-api-key-creation-1.png",alt:"Создаем ключик"},children:[]},{type:a,value:N},{type:b,tag:P,props:{src:"\u002Fimages\u002Fdev\u002Fpython\u002Fgsheets\u002Fservice-acc-api-key-creation-2.png",alt:"После создания автоматически начнется скачивание JSON-а с ключом"},children:[]},{type:a,value:f}]},{type:a,value:f},{type:b,tag:V,props:{start:S},children:[{type:a,value:f},{type:b,tag:p,props:{},children:[{type:a,value:"Даем доступ к гугл таблице для этого пользователя"}]},{type:a,value:f}]},{type:a,value:f},{type:b,tag:Z,props:{},children:[{type:a,value:N},{type:b,tag:P,props:{src:"\u002Fimages\u002Fdev\u002Fpython\u002Fgsheets\u002Fgsheets-share.png",alt:"Даем доступы"},children:[]},{type:a,value:f}]},{type:a,value:f},{type:b,tag:V,props:{start:4},children:[{type:a,value:f},{type:b,tag:p,props:{},children:[{type:a,value:"И в одну строчечку получаем "},{type:b,tag:s,props:{},children:[{type:a,value:"Сredentials"}]},{type:a,value:", с помощью которых мы можем кидать запросики"}]},{type:a,value:f}]},{type:a,value:f},{type:b,tag:v,props:{className:[K]},children:[{type:b,tag:L,props:{className:[M,R]},children:[{type:b,tag:s,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:_}]},{type:a,value:ao},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"oauth2 "},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:W}]},{type:a,value:" service_account\n\ncreds "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:m}]},{type:a,value:" service_account"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:ap},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"from_service_account_file"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,u]},children:[{type:a,value:"# Путь к json-у, полученному выше"}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:"'yaxxxta-b337157255d8.json'"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,u]},children:[{type:a,value:"# scopes - необходимые права доступа - в данном случае чтение и редактирование гугл-таблиц"}]},{type:a,value:aU},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:z}]},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:aV}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:A}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:f}]}]}]},{type:a,value:f},{type:b,tag:t,props:{},children:[{type:a,value:"Если все-таки интересует OAuth, то вот:"}]},{type:a,value:f},{type:b,tag:U,props:{id:"oauth"},children:[{type:b,tag:r,props:{href:"#oauth",ariaHidden:B,tabIndex:C},children:[{type:b,tag:c,props:{className:[D,E]},children:[]}]},{type:a,value:aS}]},{type:a,value:f},{type:b,tag:V,props:{},children:[{type:a,value:f},{type:b,tag:p,props:{},children:[{type:a,value:"Заходим на "},{type:b,tag:r,props:{href:"https:\u002F\u002Fconsole.cloud.google.com\u002Fapis\u002Fapi\u002Fsheets.googleapis.com\u002Fcredentials",rel:[F,G,H],target:I},children:[{type:a,value:"страницу создания доступов для API"}]},{type:a,value:" и создаем доступы: "},{type:b,tag:s,props:{},children:[{type:a,value:"Create credentials \u003E OAuth client ID"}]},{type:a,value:k}]},{type:a,value:f}]},{type:a,value:f},{type:b,tag:Z,props:{},children:[{type:a,value:w},{type:b,tag:P,props:{src:"\u002Fimages\u002Fdev\u002Fpython\u002Fgsheets\u002Fcredentials-creation-1.png",alt:"Страница создания доступов"},children:[]},{type:a,value:w},{type:b,tag:P,props:{src:"\u002Fimages\u002Fdev\u002Fpython\u002Fgsheets\u002Fcredentials-creation-2.png",alt:"Создание доступов: тип - Desktop app, название - произвольное"},children:[]},{type:a,value:f}]},{type:a,value:f},{type:b,tag:V,props:{start:aT},children:[{type:a,value:f},{type:b,tag:p,props:{},children:[{type:a,value:"Скачиваем доступы, получаем файлик, типа "},{type:b,tag:s,props:{},children:[{type:a,value:"client_secret_***.json"}]},{type:a,value:", и закидываем его в директорию с проектом:"}]},{type:a,value:f}]},{type:a,value:f},{type:b,tag:Z,props:{},children:[{type:a,value:w},{type:b,tag:P,props:{src:"\u002Fimages\u002Fdev\u002Fpython\u002Fgsheets\u002Fcredentials-download.png",alt:"Кнопочка скачивания доступов"},children:[]},{type:a,value:f}]},{type:a,value:f},{type:b,tag:V,props:{start:S},children:[{type:a,value:f},{type:b,tag:p,props:{},children:[{type:a,value:f},{type:b,tag:t,props:{},children:[{type:a,value:"Генерируем токен, который нужен для работы с апи, используя функцию "},{type:b,tag:s,props:{},children:[{type:a,value:aW}]},{type:a,value:k}]},{type:a,value:f},{type:b,tag:v,props:{className:[K]},children:[{type:b,tag:L,props:{className:[M,R]},children:[{type:b,tag:s,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:W}]},{type:a,value:aX},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"path\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:_}]},{type:a,value:" typing "},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:W}]},{type:a,value:" List\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:_}]},{type:a,value:ao},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"auth"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"transport"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"requests "},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:W}]},{type:a,value:" Request\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:_}]},{type:a,value:ao},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"oauth2"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"credentials "},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:W}]},{type:a,value:" Credentials\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:_}]},{type:a,value:" google_auth_oauthlib"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"flow "},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:W}]},{type:a,value:" InstalledAppFlow\n\n\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"def"}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,af]},children:[{type:a,value:aW}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:aY},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,ag]},children:[{type:a,value:aZ}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:aq},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:" List"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:z}]},{type:b,tag:c,props:{className:[d,ag]},children:[{type:a,value:aZ}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:A}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:ac}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"\u003E"}]},{type:a,value:a_},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,"triple-quoted-string",j]},children:[{type:a,value:"\"\"\"\n    Генерирует токен, необходимый для работы с апи\n\n    Токен читается из файла\n    Если этого файла нет, то используются доступы из {secrets_file}\n    После чтения доступов из файла в консоли появится ссылка, перейдя по которой надо будет авторизоваться\n\n    Если возникает надпись \"This app isn't verified\", то надо прожать  Advanced \u003E Go to {Project Name} (unsafe)\n    https:\u002F\u002Fdevelopers.google.com\u002Fsheets\u002Fapi\u002Fquickstart\u002Fpython#this_app_isnt_verified\n    \n    После авторизации токен сохранится на диск\n\n    :param secrets_file: путь к файлу с доступами, напр. 'client_secret_406798162311-63us552o41nrs0ashvt87h58gbgivjsh.apps.googleusercontent.com.json'\n    :param scopes: права доступа, необходимые для работы с апи;\n        в данном случае будет достаточно [`https:\u002F\u002Fwww.googleapis.com\u002Fauth\u002Fspreadsheets`] - это права и на чтение и на запись данных в таблицу\n    \"\"\""}]},{type:a,value:"\n    creds "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:m}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,ar]},children:[{type:a,value:"None"}]},{type:a,value:as},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:ah}]},{type:a,value:aX},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"path"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"exists"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:at}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:"\n        creds "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:m}]},{type:a,value:a_},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"from_authorized_user_file"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:at}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:aq},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:as},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:ah}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:a$}]},{type:a,value:ba},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:au}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:a$}]},{type:a,value:av},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"valid"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:O},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:ah}]},{type:a,value:ba},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aw}]},{type:a,value:av},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"expired "},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aw}]},{type:a,value:av},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"refresh_token"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:"\n            creds"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"refresh"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:ax},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:O},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bb}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:"\n            flow "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:m}]},{type:a,value:" InstalledAppFlow"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"from_client_secrets_file"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:aY},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:aq},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:"\n            creds "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:m}]},{type:a,value:" flow"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"run_local_server"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:"port"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,J]},children:[{type:a,value:ad}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:"\n\n        "},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"with"}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,ag]},children:[{type:a,value:"open"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:at}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:"'w'"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"as"}]},{type:a,value:" token"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:"\n            token"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"write"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:bc},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"to_json"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:as},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"return"}]},{type:a,value:" creds\n"}]}]}]},{type:a,value:f}]},{type:a,value:f},{type:b,tag:p,props:{},children:[{type:a,value:f},{type:b,tag:t,props:{},children:[{type:a,value:"Ну и вызываем метод выше, чтобы получить "},{type:b,tag:s,props:{},children:[{type:a,value:ap}]},{type:a,value:k}]},{type:a,value:f}]},{type:a,value:f}]},{type:a,value:f},{type:b,tag:v,props:{className:[K]},children:[{type:b,tag:L,props:{className:[M,R]},children:[{type:b,tag:s,props:{},children:[{type:a,value:"creds "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:m}]},{type:a,value:" get_creds"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:"\n    secrets_file"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:"'client_secret_406798162311-63us552o41nrs0ashvt87h58gbgivjsh.apps.googleusercontent.com.json'"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:aU},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:z}]},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:aV}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:A}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:f}]}]}]},{type:a,value:f}]},{type:a,value:f},{type:b,tag:v,props:{className:[X]},children:[{type:a,value:aa},{type:b,tag:Y,props:{id:aH},children:[{type:b,tag:r,props:{href:"#%D0%BA%D0%B8%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5-%D0%B7%D0%B0%D0%BF%D1%80%D0%BE%D1%81%D0%B8%D0%BA%D0%BE%D0%B2",ariaHidden:B,tabIndex:C},children:[{type:b,tag:c,props:{className:[D,E]},children:[]}]},{type:a,value:aI}]},{type:a,value:f},{type:b,tag:V,props:{},children:[{type:a,value:f},{type:b,tag:p,props:{},children:[{type:a,value:f},{type:b,tag:t,props:{},children:[{type:a,value:"Используя "},{type:b,tag:s,props:{},children:[{type:a,value:ap}]},{type:a,value:", создаем апи-клиент, который будет кидать запросы:"}]},{type:a,value:f},{type:b,tag:v,props:{className:[K]},children:[{type:b,tag:L,props:{className:[M,R]},children:[{type:b,tag:s,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:_}]},{type:a,value:" googleapiclient"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"discovery "},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:W}]},{type:a,value:" build\n\nservice "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:m}]},{type:a,value:" build"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:"'sheets'"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:"'v4'"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:" credentials"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:m}]},{type:a,value:bc},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:f}]}]}]},{type:a,value:f}]},{type:a,value:f},{type:b,tag:p,props:{},children:[{type:a,value:f},{type:b,tag:t,props:{},children:[{type:a,value:"Запросы кидаются аналогично путям методов, напр. для запроса "},{type:b,tag:s,props:{},children:[{type:a,value:ay}]},{type:a,value:" вызов будет выглядеть так:"}]},{type:a,value:f},{type:b,tag:v,props:{className:[K]},children:[{type:b,tag:L,props:{className:[M,R]},children:[{type:b,tag:s,props:{},children:[{type:a,value:bd},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:m}]},{type:a,value:be},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:ai},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:aj},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"**"}]},{type:a,value:"params"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:az},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:f}]}]}]},{type:a,value:f}]},{type:a,value:f}]},{type:a,value:f}]},{type:a,value:f},{type:b,tag:v,props:{className:[X]},children:[{type:a,value:aa},{type:b,tag:Y,props:{id:aJ},children:[{type:b,tag:r,props:{href:"#%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D0%B5-%D0%BF%D0%B5%D1%80%D0%B5%D0%B4%D0%B0%D0%B2%D0%B0%D0%B5%D0%BC%D1%8B%D0%B5-%D0%B2-%D0%BF%D0%B0%D1%80%D0%B0%D0%BC%D0%B5%D1%82%D1%80%D0%B0%D1%85",ariaHidden:B,tabIndex:C},children:[{type:b,tag:c,props:{className:[D,E]},children:[]}]},{type:a,value:aK}]},{type:a,value:f},{type:b,tag:U,props:{id:"tablica-i-listy"},children:[{type:b,tag:r,props:{href:"#%D1%82%D0%B0%D0%B1%D0%BB%D0%B8%D1%86%D0%B0-%D0%B8-%D0%BB%D0%B8%D1%81%D1%82%D1%8B",ariaHidden:B,tabIndex:C},children:[{type:b,tag:c,props:{className:[D,E]},children:[]}]},{type:a,value:"Таблица и листы"}]},{type:a,value:f},{type:b,tag:t,props:{},children:[{type:a,value:"Для любого запроса необходим айди таблицы и айди листа; причем айди листа может быть как строковым, так и числовым."}]},{type:a,value:f},{type:b,tag:t,props:{},children:[{type:a,value:"Получить эти данные можно из ссылки на таблицу. Например, для такой ссылки:"}]},{type:a,value:f},{type:b,tag:v,props:{className:[K]},children:[{type:b,tag:L,props:{className:[M,aQ]},children:[{type:b,tag:s,props:{},children:[{type:a,value:"https:\u002F\u002Fdocs.google.com\u002Fspreadsheets\u002Fd\u002Fe3b0c44298fc1c149afbf4c8996fb92427\u002Fedit#gid=1340597691\n"}]}]}]},{type:a,value:f},{type:b,tag:Q,props:{},children:[{type:a,value:f},{type:b,tag:p,props:{},children:[{type:a,value:"e3b0c44298fc1c149afbf4c8996fb92427 - айди таблицы"}]},{type:a,value:f},{type:b,tag:p,props:{},children:[{type:a,value:"1340597691 - численный айди листа"}]},{type:a,value:f},{type:b,tag:p,props:{},children:[{type:a,value:"Строковой айди листа — это собственно название листа"}]},{type:a,value:f}]},{type:a,value:f},{type:b,tag:t,props:{},children:[{type:a,value:"Вынесем это в константы, которые будем юзать в примерах запросов:"}]},{type:a,value:f},{type:b,tag:v,props:{className:[K]},children:[{type:b,tag:L,props:{className:[M,R]},children:[{type:b,tag:s,props:{},children:[{type:a,value:"TABLE "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:m}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:"'e3b0c44298fc1c149afbf4c8996fb92427'"}]},{type:a,value:"\nSHEET "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:m}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:"\"Лист 1\""}]},{type:a,value:"\nSHEET_ID "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:m}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,J]},children:[{type:a,value:"1340597691"}]},{type:a,value:f}]}]}]},{type:a,value:f},{type:b,tag:U,props:{id:"diapazon-aka-range"},children:[{type:b,tag:r,props:{href:"#%D0%B4%D0%B8%D0%B0%D0%BF%D0%B0%D0%B7%D0%BE%D0%BD-%D0%B0%D0%BA%D0%B0-range",ariaHidden:B,tabIndex:C},children:[{type:b,tag:c,props:{className:[D,E]},children:[]}]},{type:a,value:"Диапазон ака range"}]},{type:a,value:f},{type:b,tag:t,props:{},children:[{type:a,value:"Диапазон ячеек, над которыми будут проводиться операции, определяется в 2 форматах:"}]},{type:a,value:f},{type:b,tag:Q,props:{},children:[{type:a,value:f},{type:b,tag:p,props:{},children:[{type:a,value:"Строка вида \"Лист 1!A1:B2\" - классический формат диапазонов, включающий название листа, название колонки в виде буквы, и номер строки"}]},{type:a,value:f},{type:b,tag:p,props:{},children:[{type:b,tag:r,props:{href:"https:\u002F\u002Fdevelopers.google.com\u002Fsheets\u002Fapi\u002Freference\u002Frest\u002Fv4\u002Fspreadsheets\u002Fother#GridRange",rel:[F,G,H],target:I},children:[{type:a,value:"Объект GridRange"}]},{type:a,value:", использующий индексы строк и колонок"}]},{type:a,value:f}]},{type:a,value:f},{type:b,tag:t,props:{},children:[{type:a,value:"Аналогично определим их в виде констант:"}]},{type:a,value:f},{type:b,tag:v,props:{className:[K]},children:[{type:b,tag:L,props:{className:[M,R]},children:[{type:b,tag:s,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:_}]},{type:a,value:" openpyxl"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"utils"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"cell "},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:W}]},{type:a,value:" column_index_from_string\n\n"},{type:b,tag:c,props:{className:[d,u]},children:[{type:a,value:"# Строка вида \"Лист 1!D5:GJ396\""}]},{type:a,value:"\nSTART_COLUMN"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:bf},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:m}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:"\"D\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,J]},children:[{type:a,value:"5"}]},{type:a,value:"\nEND_COL"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:bg},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:m}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:"\"GJ\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,J]},children:[{type:a,value:"396"}]},{type:a,value:"\nRANGE_STR "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:m}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,"string-interpolation"]},children:[{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:"F'"}]},{type:b,tag:c,props:{className:[d,ae]},children:[{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:x}]},{type:a,value:"SHEET"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:y}]}]},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:"!"}]},{type:b,tag:c,props:{className:[d,ae]},children:[{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:x}]},{type:a,value:bh},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:y}]}]},{type:b,tag:c,props:{className:[d,ae]},children:[{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:x}]},{type:a,value:"START_ROW"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:y}]}]},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:k}]},{type:b,tag:c,props:{className:[d,ae]},children:[{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:x}]},{type:a,value:bi},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:y}]}]},{type:b,tag:c,props:{className:[d,ae]},children:[{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:x}]},{type:a,value:"END_ROW"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:y}]}]},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:"'"}]}]},{type:a,value:"\n\n"},{type:b,tag:c,props:{className:[d,u]},children:[{type:a,value:"# Объект GridRange"}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,u]},children:[{type:a,value:"# Индексы колонок и строк начинаются с 0, "}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,u]},children:[{type:a,value:"# то есть для ячейки A1 будут индексы 0 и 0, для ячейки D5 будут индексы 3 и 4"}]},{type:a,value:"\nSTART_COL_INDEX "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:m}]},{type:a,value:bj},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:bh},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:ac}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,J]},children:[{type:a,value:ab}]},{type:a,value:"\nSTART_ROW_INDEX "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:m}]},{type:a,value:bf},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:ac}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,J]},children:[{type:a,value:ab}]},{type:a,value:"\nEND_COL_INDEX "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:m}]},{type:a,value:bj},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:bi},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:ac}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,J]},children:[{type:a,value:ab}]},{type:a,value:"\nEND_ROW_INDEX "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:m}]},{type:a,value:bg},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:ac}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,J]},children:[{type:a,value:ab}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,u]},children:[{type:a,value:"# GridRange наполовину инклюзивный - [startIndex, endIndex), "}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,u]},children:[{type:a,value:"# т.е. включает начальный индекс диапазона и не включает конечный индекс, "}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,u]},children:[{type:a,value:"# т.е. чтобы включить последний индекс нужно плюсануть 1"}]},{type:a,value:"\nRANGE "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:m}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:x}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:"\"sheetId\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:" SHEET_ID"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:"\"startRowIndex\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:" START_ROW_INDEX"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:"\"startColumnIndex\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:" START_COL_INDEX"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:"\"endRowIndex\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:" END_ROW_INDEX "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aA}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,J]},children:[{type:a,value:ab}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:"\"endColumnIndex\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:" END_COL_INDEX "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aA}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,J]},children:[{type:a,value:ab}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:y}]},{type:a,value:f}]}]}]},{type:a,value:f},{type:b,tag:bk,props:{},children:[{type:a,value:f},{type:b,tag:t,props:{},children:[{type:a,value:"Для перевода буквенных колонок в число, можно использовать метод "},{type:b,tag:s,props:{},children:[{type:a,value:"column_index_from_string"}]},{type:a,value:" из библиотеки "},{type:b,tag:r,props:{href:"https:\u002F\u002Fopenpyxl.readthedocs.io\u002Fen\u002Fstable\u002F",rel:[F,G,H],target:I},children:[{type:a,value:"openpyxl"}]}]},{type:a,value:f}]},{type:a,value:f}]},{type:a,value:f},{type:b,tag:v,props:{className:[X]},children:[{type:a,value:aa},{type:b,tag:Y,props:{id:aL},children:[{type:b,tag:r,props:{href:"#%D0%BF%D1%80%D0%B8%D0%BC%D0%B5%D1%80-%D0%BE%D0%B1%D0%BD%D0%BE%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D1%81%D1%81%D1%8B%D0%BB%D0%BE%D0%BA-%D0%B2-%D1%8F%D1%87%D0%B5%D0%B9%D0%BA%D0%B0%D1%85",ariaHidden:B,tabIndex:C},children:[{type:b,tag:c,props:{className:[D,E]},children:[]}]},{type:a,value:aM}]},{type:a,value:f},{type:b,tag:t,props:{},children:[{type:a,value:"Рассмотрим как пользоваться методами апи на примере задачи обновления ссылок."}]},{type:a,value:f},{type:b,tag:t,props:{},children:[{type:a,value:"Суть задачи — проверить есть ли в ячейке ссылка, если есть, то нужно заменить в ссылке домен."}]},{type:a,value:f},{type:b,tag:U,props:{id:"spreadsheetsget"},children:[{type:b,tag:r,props:{href:"#spreadsheetsget",ariaHidden:B,tabIndex:C},children:[{type:b,tag:c,props:{className:[D,E]},children:[]}]},{type:a,value:ay}]},{type:a,value:f},{type:b,tag:t,props:{},children:[{type:a,value:"Метод "},{type:b,tag:r,props:{href:"https:\u002F\u002Fdevelopers.google.com\u002Fsheets\u002Fapi\u002Freference\u002Frest\u002Fv4\u002Fspreadsheets\u002Fget",rel:[F,G,H],target:I},children:[{type:a,value:ay}]},{type:a,value:" позволяет получить всю информацию о таблице, то есть помимо значений ячеек можно получить информацию о стилях и ссылках."}]},{type:a,value:f},{type:b,tag:t,props:{},children:[{type:a,value:"Пример вызова:"}]},{type:a,value:f},{type:b,tag:v,props:{className:[K]},children:[{type:b,tag:L,props:{className:[M,R]},children:[{type:b,tag:s,props:{},children:[{type:a,value:bd},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:m}]},{type:a,value:be},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:ai},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:aj},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:bl},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:m}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:"\n    ranges"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:z}]},{type:a,value:bm},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:A}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,u]},children:[{type:a,value:"# Нужно, чтобы приходила инфа о ячейках"}]},{type:a,value:"\n    includeGridData"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,ar]},children:[{type:a,value:"True"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:az},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:"\nrows "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:m}]},{type:a,value:bn},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:z}]},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:"\"sheets\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:A}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:z}]},{type:b,tag:c,props:{className:[d,J]},children:[{type:a,value:ad}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:A}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:z}]},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:"\"data\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:A}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:z}]},{type:b,tag:c,props:{className:[d,J]},children:[{type:a,value:ad}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:A}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:z}]},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:"\"rowData\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:A}]},{type:a,value:f}]}]}]},{type:a,value:f},{type:b,tag:Q,props:{},children:[{type:a,value:f},{type:b,tag:p,props:{},children:[{type:b,tag:s,props:{},children:[{type:a,value:"resp"}]},{type:a,value:" - это большой объект, включающий в себя, помимо данных о ячейках, другие данные, напр. данных о листах"}]},{type:a,value:f},{type:b,tag:p,props:{},children:[{type:b,tag:s,props:{},children:[{type:a,value:"rows = resp[\"sheets\"][0][\"data\"][0][\"rowData\"]"}]},{type:a,value:" - таким образом получаем данные о строках"}]},{type:a,value:f},{type:b,tag:p,props:{},children:[{type:b,tag:s,props:{},children:[{type:a,value:"cells = rows[0][\"values\"]"}]},{type:a,value:" - таким образом получаем ячейки строки"}]},{type:a,value:f}]},{type:a,value:f},{type:b,tag:U,props:{id:"algoritm-zameny-ssylok"},children:[{type:b,tag:r,props:{href:"#%D0%B0%D0%BB%D0%B3%D0%BE%D1%80%D0%B8%D1%82%D0%BC-%D0%B7%D0%B0%D0%BC%D0%B5%D0%BD%D1%8B-%D1%81%D1%81%D1%8B%D0%BB%D0%BE%D0%BA",ariaHidden:B,tabIndex:C},children:[{type:b,tag:c,props:{className:[D,E]},children:[]}]},{type:a,value:"Алгоритм замены ссылок"}]},{type:a,value:f},{type:b,tag:t,props:{},children:[{type:a,value:"Теперь напишем алгоритм замены ссылок, который будет создавать массив обновлений ячеек — массив "},{type:b,tag:r,props:{href:"https:\u002F\u002Fdevelopers.google.com\u002Fsheets\u002Fapi\u002Freference\u002Frest\u002Fv4\u002Fspreadsheets\u002Fsheets#RowData",rel:[F,G,H],target:I},children:[{type:a,value:"RowData"}]},{type:a,value:k}]},{type:a,value:f},{type:b,tag:v,props:{className:[K]},children:[{type:b,tag:L,props:{className:[M,R]},children:[{type:b,tag:s,props:{},children:[{type:a,value:"old_url "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:m}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:"'https:\u002F\u002Fgoogle.com\u002F'"}]},{type:a,value:"\nnew_url "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:m}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:"\"https:\u002F\u002Fyandex.ru\u002F\""}]},{type:a,value:"\n\nupdate_rows "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:m}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:z}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:A}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bo}]},{type:a,value:" row "},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bp}]},{type:a,value:" rows"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:"\n    update_cells "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:m}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:z}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:A}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bo}]},{type:a,value:" cell "},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bp}]},{type:a,value:" row"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:z}]},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:bq}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:A}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:"\n        link "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:m}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:T},{type:b,tag:c,props:{className:[d,u]},children:[{type:a,value:"# Если ссылка выставлена для всей ячейки, то берем hyperlink"}]},{type:a,value:"\n            cell"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:aj},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:"\"hyperlink\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:au}]},{type:a,value:T},{type:b,tag:c,props:{className:[d,u]},children:[{type:a,value:"# Если ссылка выставлена для части ячейки, например \"*Тут* хорошо\", то ссылка берется из textFormatRuns.0.format.link.uri"}]},{type:a,value:br},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:bs},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:"\"textFormatRuns.0.format.link.uri\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:au}]},{type:a,value:T},{type:b,tag:c,props:{className:[d,u]},children:[{type:a,value:"# Еще ссылка может быть выставлена для другой части ячейки, например \"Хорошо *тут*\""}]},{type:a,value:T},{type:b,tag:c,props:{className:[d,u]},children:[{type:a,value:"# в таком случае ссылка берется из textFormatRuns.1.format.link.uri"}]},{type:a,value:br},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:bs},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:"\"textFormatRuns.1.format.link.uri\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:O},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:O},{type:b,tag:c,props:{className:[d,u]},children:[{type:a,value:"# Задавать ссылку для ячейки можно 3 способами"}]},{type:a,value:O},{type:b,tag:c,props:{className:[d,u]},children:[{type:a,value:"# https:\u002F\u002Fdevelopers.google.com\u002Fsheets\u002Fapi\u002Freference\u002Frest\u002Fv4\u002Fspreadsheets\u002Fcells#CellData.FIELDS.hyperlink"}]},{type:a,value:O},{type:b,tag:c,props:{className:[d,u]},children:[{type:a,value:"# Будем использовать textFormatRun.format.link, т.к. он самый рабочий из тех, что я пробовал"}]},{type:a,value:O},{type:b,tag:c,props:{className:[d,u]},children:[{type:a,value:"# https:\u002F\u002Fdevelopers.google.com\u002Fsheets\u002Fapi\u002Freference\u002Frest\u002Fv4\u002Fspreadsheets\u002Fother#TextFormat.FIELDS.link"}]},{type:a,value:"\n        update_link "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:m}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:T},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:x}]},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:"\"userEnteredFormat\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:x}]},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:"\"textFormat\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:x}]},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:"\"link\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:x}]},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:"\"uri\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:" new_url "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aA}]},{type:a,value:bt},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:z}]},{type:b,tag:c,props:{className:[d,ag]},children:[{type:a,value:"len"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:bu},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:A}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:y}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:y}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:y}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:y}]},{type:a,value:T},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:ah}]},{type:a,value:" link "},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aw}]},{type:a,value:bt},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"startswith"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:bu},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:T},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bb}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:x}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:y}]},{type:a,value:O},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:"\n        update_cells"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:bv},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:"update_link"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:"\n\n    update_rows"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:bv},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:x}]},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:bq}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:" update_cells"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:y}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:f}]}]}]},{type:a,value:f},{type:b,tag:bk,props:{},children:[{type:a,value:f},{type:b,tag:t,props:{},children:[{type:a,value:"Текст функции "},{type:b,tag:s,props:{},children:[{type:a,value:"value_by_path"}]},{type:a,value:" будет приведен в итоговом коде скрипта"}]},{type:a,value:f}]},{type:a,value:f},{type:b,tag:U,props:{id:"spreadsheetsbatchupdate"},children:[{type:b,tag:r,props:{href:"#spreadsheetsbatchupdate",ariaHidden:B,tabIndex:C},children:[{type:b,tag:c,props:{className:[D,E]},children:[]}]},{type:a,value:aB}]},{type:a,value:f},{type:b,tag:t,props:{},children:[{type:a,value:"Наконец нужно вызвать метод обновления данных таблицы - "},{type:b,tag:r,props:{href:"https:\u002F\u002Fdevelopers.google.com\u002Fsheets\u002Fapi\u002Freference\u002Frest\u002Fv4\u002Fspreadsheets\u002FbatchUpdate",rel:[F,G,H],target:I},children:[{type:a,value:aB}]},{type:a,value:i}]},{type:a,value:f},{type:b,tag:t,props:{},children:[{type:a,value:"Чтобы вызвать метод "},{type:b,tag:s,props:{},children:[{type:a,value:aB}]},{type:a,value:" нужно передать в него массив "},{type:b,tag:r,props:{href:"https:\u002F\u002Fdevelopers.google.com\u002Fsheets\u002Fapi\u002Freference\u002Frest\u002Fv4\u002Fspreadsheets\u002Frequest#Request",rel:[F,G,H],target:I},children:[{type:a,value:ax}]},{type:a,value:". Объект "},{type:b,tag:s,props:{},children:[{type:a,value:ax}]},{type:a,value:" олицетворяет операцию над таблицей, такую как вставка графиков, удаление ячеек, добавление листов и другие. Нас интересует обновление ячеек — то есть "},{type:b,tag:r,props:{href:"https:\u002F\u002Fdevelopers.google.com\u002Fsheets\u002Fapi\u002Freference\u002Frest\u002Fv4\u002Fspreadsheets\u002Frequest#updatecellsrequest",rel:[F,G,H],target:I},children:[{type:a,value:"UpdateCellsRequest"}]},{type:a,value:k}]},{type:a,value:f},{type:b,tag:v,props:{className:[K]},children:[{type:b,tag:L,props:{className:[M,R]},children:[{type:b,tag:s,props:{},children:[{type:a,value:"service"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:ai},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:bw},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:bl},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:m}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:"\n    body"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:x}]},{type:a,value:O},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:"\"requests\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:z}]},{type:a,value:T},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:x}]},{type:a,value:"\n                "},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:"\"updateCells\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:x}]},{type:a,value:al},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:"\"rows\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:bx},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:al},{type:b,tag:c,props:{className:[d,u]},children:[{type:a,value:"# Здесь указывается какие поля обновляем"}]},{type:a,value:al},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:"\"fields\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:by}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:al},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:"\"range\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:" RANGE\n                "},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:y}]},{type:a,value:T},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:y}]},{type:a,value:O},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:A}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:y}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:az},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:f}]}]}]},{type:a,value:f},{type:b,tag:t,props:{},children:[{type:a,value:"Все, можно запускать код."}]},{type:a,value:f},{type:b,tag:t,props:{},children:[{type:a,value:"Код выгрузит ячейки таблицы в диапазоне и заменит ссылки, содержащие google.com, на yandex.ru."}]},{type:a,value:f}]},{type:a,value:f},{type:b,tag:v,props:{className:[X]},children:[{type:a,value:aa},{type:b,tag:Y,props:{id:aN},children:[{type:b,tag:r,props:{href:"#%D1%81%D1%81%D1%8B%D0%BB%D0%BE%D1%87%D0%BA%D0%B8",ariaHidden:B,tabIndex:C},children:[{type:b,tag:c,props:{className:[D,E]},children:[]}]},{type:a,value:aO}]},{type:a,value:f},{type:b,tag:Q,props:{},children:[{type:a,value:f},{type:b,tag:p,props:{},children:[{type:b,tag:r,props:{href:"https:\u002F\u002Fgist.github.com\u002Fpotykion\u002F880b9971cfd54700ddc93410722a2149",rel:[F,G,H],target:I},children:[{type:a,value:"Итоговый код скрипта"}]}]},{type:a,value:f},{type:b,tag:p,props:{},children:[{type:b,tag:r,props:{href:"https:\u002F\u002Fdevelopers.google.com\u002Fsheets\u002Fapi\u002Fquickstart\u002Fpython",rel:[F,G,H],target:I},children:[{type:a,value:"Начало работы с Sheets API в Python"}]}]},{type:a,value:f}]},{type:a,value:f}]},{type:a,value:f},{type:b,tag:v,props:{className:[X]},children:[{type:a,value:aa},{type:b,tag:Y,props:{id:aP},children:[{type:b,tag:r,props:{href:"#apps-script",ariaHidden:B,tabIndex:C},children:[{type:b,tag:c,props:{className:[D,E]},children:[]}]},{type:a,value:an}]},{type:a,value:f},{type:b,tag:Q,props:{},children:[{type:a,value:f},{type:b,tag:p,props:{},children:[{type:a,value:"А еще есть "},{type:b,tag:r,props:{href:"https:\u002F\u002Fdevelopers.google.com\u002Fapps-script",rel:[F,G,H],target:I},children:[{type:a,value:an}]},{type:a,value:" - это JS-подобный язык (бтв ему 12 лет)))), только там из коробки гугловые апишки + можно напрямую взаимодействовать с гугловыми сервисами, типа плагины писать для гугл-шитс"}]},{type:a,value:f},{type:b,tag:p,props:{},children:[{type:a,value:"И самое главное - не нужно вообще писать код для авторизации \u002F делать какие-либо телодвижения по этому поводу"}]},{type:a,value:f},{type:b,tag:p,props:{},children:[{type:a,value:"То есть для Apps Script часть с Авторизацией можно пропустить и сразу юзать методы апи:"}]},{type:a,value:f}]},{type:a,value:f},{type:b,tag:v,props:{className:[K]},children:[{type:b,tag:L,props:{className:[M,"language-js"]},children:[{type:b,tag:s,props:{},children:[{type:a,value:"  "},{type:b,tag:c,props:{className:[d,u]},children:[{type:a,value:"\u002F\u002F Метод spreadsheets.get"}]},{type:a,value:N},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bz}]},{type:a,value:" resp "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:m}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,bA]},children:[{type:a,value:"Sheets"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,$]},children:[{type:b,tag:c,props:{className:[d,bA]},children:[{type:a,value:"Spreadsheets"}]}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,aC,af,$]},children:[{type:a,value:aj}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,am]},children:[{type:a,value:ak}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:" \n    "},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:x}]},{type:a,value:"\n      ranges"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:k}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:z}]},{type:b,tag:c,props:{className:[d,am]},children:[{type:a,value:bm}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:A}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:" \n      includeGridData"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:k}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,ar]},children:[{type:a,value:B}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:y}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:N},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:bB}]},{type:a,value:N},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bz}]},{type:a,value:" rows "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:m}]},{type:a,value:bn},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,$]},children:[{type:a,value:"sheets"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:z}]},{type:b,tag:c,props:{className:[d,J]},children:[{type:a,value:ad}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:A}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,$]},children:[{type:a,value:"data"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:z}]},{type:b,tag:c,props:{className:[d,J]},children:[{type:a,value:ad}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:A}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,$]},children:[{type:a,value:"rowData"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:bB}]},{type:a,value:"\n  \n  "},{type:b,tag:c,props:{className:[d,u]},children:[{type:a,value:"\u002F\u002F Метод spreadsheets.batchUpdate"}]},{type:a,value:"\n  service"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,aC,af,$]},children:[{type:a,value:ai}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,aC,af,$]},children:[{type:a,value:bw}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:x}]},{type:a,value:"\n      requests"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:k}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:z}]},{type:a,value:O},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:x}]},{type:a,value:"\n          updateCells"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:k}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:x}]},{type:a,value:"\n            rows"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:k}]},{type:a,value:bx},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:"\n            fields"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:k}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:by}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:"\n            range"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:k}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,am]},children:[{type:a,value:"RANGE"}]},{type:a,value:"\n          "},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:y}]},{type:a,value:O},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:y}]},{type:a,value:"\n      "},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:A}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:y}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,am]},children:[{type:a,value:ak}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:N},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:f}]}]}]},{type:a,value:f},{type:b,tag:Q,props:{},children:[{type:a,value:f},{type:b,tag:p,props:{},children:[{type:a,value:"Запускать это дело можно из "},{type:b,tag:r,props:{href:"https:\u002F\u002Fscript.google.com\u002Fhome",rel:[F,G,H],target:I},children:[{type:a,value:"редактора"}]},{type:a,value:k}]},{type:a,value:f}]},{type:a,value:f},{type:b,tag:Z,props:{},children:[{type:a,value:N},{type:b,tag:P,props:{src:"\u002Fimages\u002Fdev\u002Fpython\u002Fgsheets\u002Fapps-script-editor.png",alt:"Apps Script редактор"},children:[]},{type:a,value:f}]},{type:a,value:f},{type:b,tag:U,props:{id:"plaginy"},children:[{type:b,tag:r,props:{href:"#%D0%BF%D0%BB%D0%B0%D0%B3%D0%B8%D0%BD%D1%8B",ariaHidden:B,tabIndex:C},children:[{type:b,tag:c,props:{className:[D,E]},children:[]}]},{type:a,value:"Плагины"}]},{type:a,value:f},{type:b,tag:Q,props:{},children:[{type:a,value:f},{type:b,tag:p,props:{},children:[{type:a,value:"Как я говорил, можно плагины писать для тех же Гугл таблиц"}]},{type:a,value:f},{type:b,tag:p,props:{},children:[{type:a,value:"Вот "},{type:b,tag:r,props:{href:"https:\u002F\u002Fdevelopers.google.com\u002Fyoutube\u002Fv3\u002Fquickstart\u002Fapps-script",rel:[F,G,H],target:I},children:[{type:a,value:"пример работы с Youtube API"}]},{type:a,value:", который добавляет в Гугл таблицу кастомную кнопулю, которая подгружает данные о YT-канале:"}]},{type:a,value:f}]},{type:a,value:f},{type:b,tag:Z,props:{},children:[{type:a,value:N},{type:b,tag:P,props:{src:"\u002Fimages\u002Fdev\u002Fpython\u002Fgsheets\u002Fapps-script-gsheet-integration.png",alt:"Кастомная кнопочка в Google Sheets"},children:[]},{type:a,value:f}]},{type:a,value:f},{type:b,tag:Q,props:{},children:[{type:a,value:f},{type:b,tag:p,props:{},children:[{type:a,value:"Возможно, это не так удобно как из Питона, но суть в том, что такой инструмент существует, и мб для каких-то задач он пригоден"}]},{type:a,value:f}]},{type:a,value:f}]}]},dir:"\u002Fdev\u002Fpy",path:"\u002Fdev\u002Fpy\u002Fgsheets",extension:".md",createdAt:bC,updatedAt:bC}}],fetch:{},mutations:[]}}("text","element","span","token","punctuation","\n","operator"," ",".","string",":","keyword","=","(",")","li",",","a","code","p","comment","div","\n    ","{","}","[","]","true",-1,"icon","icon-link","nofollow","noopener","noreferrer","_blank","number","nuxt-content-highlight","pre","line-numbers","\n  ","\n        ","img-block","ul","language-python",3,"\n            ","h4","ol","import","mendel-card","h3","img-swiper","from","property-access"," \n","1","-","0","interpolation","function","builtin","if","spreadsheets","get","TABLE","\n                    ","constant","Apps Script"," google","Credentials"," scopes","boolean","\n\n    ","'token.json'","or"," creds","and","Request","spreadsheets.get","execute","+","spreadsheets.batchUpdate","method","prerekvizity","Пререквизиты","avtorizaciya","Авторизация","kidanie-zaprosikov","Кидание запросиков","dannye-peredavaemye-v-parametrah","Данные, передаваемые в параметрах","primer-obnovlenie-ssylok-v-yacheykah","Пример: обновление ссылок в ячейках","ssylochki","Ссылочки","apps-script","language-text","strong","OAuth",2,"\n    scopes","'https:\u002F\u002Fwww.googleapis.com\u002Fauth\u002Fspreadsheets'","get_creds"," os","secrets_file","str"," Credentials","not"," creds ","else","creds","resp "," service"," START_ROW "," END_ROW ","START_COLUMN","END_COL"," column_index_from_string","blockquote","\n    spreadsheetId","RANGE_STR"," resp","for","in","\"values\"","\n            value_by_path","cell"," link","old_url","append","batchUpdate"," update_rows","\"userEnteredFormat.textFormat.link.uri\"","const","maybe-class-name",";","2022-06-01T15:22:47.342Z")));